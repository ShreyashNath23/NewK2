# K2 Summit Challenge

## DBT Unified Schema Generator & Visualizer

This project generates a unified schema from multiple DBT project manifests, enhances the schema with AI-generated column descriptions (via the Hugging Face Inference API), builds a network graph of model dependencies, and visualizes the lineage graph using Pyvis.

## Features

### Unified Schema Generation
- Loads DBT manifest files from different projects, extracts model information, and unifies them into one schema.

### AI-Enhanced Column Descriptions
- Uses the Hugging Face API to generate detailed technical descriptions for each column based on its name, data type, and context.

### Graph Building & Visualization
- Constructs a directed graph representing model dependencies and visualizes the lineage graph interactively with Pyvis.

### Schema Export
- Exports the enhanced unified schema (including AI descriptions) to a JSON file.

## Prerequisites
- Python 3.7 or later
- pip (Python package installer)

## Installation

### 1. Clone the Repository
```bash
git clone <repository link>
cd <repository folder>
```

### 2. Install Dependencies
```bash
pip install networkx requests pyvis pandas
```

### 3. Folder Structure
Place the DBT project directory inside `F:/dbt_projects`. If your `dbt_projects` folder is located elsewhere, update the correct path at **line 205** in the file `schema2.py`.

### 4. Configure Hugging Face API
This project uses the Hugging Face API to generate column descriptions.

#### Steps to Get the API Key:
1. Log in to [Hugging Face](https://huggingface.co/).
2. Click on your profile picture.
3. Select **Access Token** from the dropdown menu.
4. Create and copy the API key.
5. Replace the `'*'` at **line 204** in `schema2.py` with your API key.

---

## Intuitive DBT UI
This project includes a Streamlit application that visualizes DBT models, columns, relationships, and metadata from a unified schema file.

### Features:
- **Unified Schema Upload:** Upload a single unified schema file (e.g., `enhanced_schema.json`) that combines manifest data from multiple DBT projects.
- **Filters & Search:** Filter models by project and search by model ID or name.
- **Models Overview:** Displays each model with a formatted name and a table of its columns, data types, and AI-generated descriptions.
- **Model Details:** View detailed metadata for a selected model, including its project, ID, description, columns, and dependencies.
- **Lineage Graph:** An interactive graph (using Pyvis) shows relationships between models.

### Running the Application

#### 1. Start the Streamlit App
```bash
streamlit run app.py
```

#### 2. Upload the Unified Schema File
- Use the **"Upload Unified Schema File"** option in the application sidebar to upload `enhanced_schema.json`.
- The app will process the file and display:
  - **Models Overview:** Cards for each model with a table of column details.
  - **Model Details:** A detailed view of a selected model, including metadata, columns, and dependencies.
  - **Lineage Graph:** An interactive visualization of model relationships.

---

## Files Included

- **`app.py`**: The main Streamlit application file. Loads the unified schema, provides filters and search, and displays model overviews, details, and lineage graphs.
- **`enhanced_schema.json`**: The unified schema file containing:
  - **meta**: Metadata about schema generation.
  - **nodes**: An array of model objects with details such as ID, project, columns, description, and original name.
  - **edges**: An array of relationship objects with source and target keys.
  - **ai_descriptions**: Additional AI-generated descriptions for columns.
- **`lineage.html`**: The interactive lineage graph visualization generated by Pyvis.

---

## Troubleshooting

### No Models Loaded
- If you see **"No models match the current filters"**, verify that the uploaded unified schema file is correctly structured and that the project names match the filters.

### File Upload Issues
- Ensure that you are uploading a valid JSON file with the correct structure.

### Visualization Problems
- Confirm that all dependencies (e.g., Pyvis) are installed.
- Ensure you have write permissions in the directory for generating `lineage.html`.

---

## License
This project is licensed under the MIT License.

---

## Contributing
Feel free to submit issues or pull requests to improve this project!
